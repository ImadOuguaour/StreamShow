import{r as n,m as j,n as E,o as P,p as D,k as N,u as w,q as A,l as M,j as e,M as m}from"./index-CIfbRj8A.js";import{D as _}from"./index-qVga2gby.js";import{a as v,T as C}from"./index-CIRuzrdE.js";const F=(a,t)=>{const[r,c]=n.useState(a);return n.useEffect(()=>{const i=setTimeout(()=>{c(a)},t);return()=>{clearTimeout(i)}},[a,t]),r},I="92b418e837b833be308bbfb1fb2aca1e",V=(a,t=1)=>async r=>{r(j());try{const c=await v.get(`${C}/search/multi?api_key=${I}&query=${a}&language=en-US&page=${t}`);r(E(c.data))}catch(c){console.log("error when fetching movies : ",c),r(P())}},L=()=>{const[a,t]=D(),[r,c]=n.useState(()=>a.get("search")||""),[i,u]=n.useState(1),{resultSearch:d,loading:g,error:f,totalResults:l}=N(s=>s.search),h=w(),p=A(),o=F(r,1500);n.useEffect(()=>{o?t({search:o}):(a.delete("search"),t(a),h(M()))},[o,a,t,h]),n.useEffect(()=>{o&&h(V(o,i))},[o,i,h]);const x=()=>{u(s=>s+1)},b=()=>{u(s=>s>1?s-1:s)},y=s=>{const S=s.target.value;u(1),c(S)};return e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"bg-gradient-to-b from-gray-900 to-gray-800 p-4 flex items-start justify-center",children:e.jsx("input",{className:"bg-gradient-to-b from-gray-900 to-gray-800 mt-10 px-4 py-2 w-1/2 md:w-1/3 border border-gray-300 rounded-md shadow-md text-white",onChange:y,placeholder:p.formatMessage({id:"searchPlaceholder"}),type:"text",value:r})}),e.jsx("div",{className:"bg-gradient-to-b from-gray-900 to-gray-800 text-white py-2 items-start justify-center pl-3",children:l===0?e.jsx("span",{children:e.jsx(m,{id:"noItemFound"})}):e.jsxs("span",{children:[l," ",e.jsx(m,{id:"itemsFound"})]})}),e.jsx("div",{className:"bg-gradient-to-b from-gray-900 to-gray-800 min-h-screen p-4",children:(d==null?void 0:d.length)>0&&e.jsx(_,{currentPage:i,error:f,loading:g,medias:d,onNextPage:x,onPreviousPage:b})})]})};export{L as default};
